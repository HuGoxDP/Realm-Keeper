**Версия:** 0.3  
**Жанр:** 3D Open-World Base Defense / Strategy / Roguelite  
**Ядро игрового процесса:** Постройка самодостаточной базы, круговая оборона от волн врагов, тактический выбор перманентных и временных улучшений через углублённую систему Советников.
### 1. Концепция (High Concept)

**«Factorio встречается с They Are Billions и карточными играми»**. Игрок — хранитель королевской реликвии. Он должен освоить опасную территорию, построить экономику, возвести неприступную крепость и отражать наступления врагов, которые атакуют со всех сторон, используя комбинации улучшений от мистических Советников, лояльность к которым нужно заслужить.

---

### 2. Основной игровой цикл (Core Loop)

1. **ВОЛНА:** Отражение атаки врагов на вашу базу.
    
2. **АНАЛИЗ & ДОБЫЧА:** Оценка ущерба, ремонт, активная добыча ресурсов на карте.
    
3. **ПЛАНИРОВАНИЕ:** Расширение базы, укрепление периметра, постройка новых зданий.
    
4. **СОВЕТ (2-этапный):**
    
    - **ШАГ 1:** Выбор одного из трёх Советников.
        
    - **ШАГ 2:** Выбор одного из трёх улучшений у выбранного Советника.
        
5. **ПОДГОТОВКА:** Ожидание следующей, более сложной волны. Цикл повторяется.
    

---

### 3. Ключевые механики 

#### 3.1. Мир и ресурсы

- **Локация:** Одна большая карта (256x256 или 512x512 юнитов). Генерация: случайная или hand-crafted. Ландшафт: равнина с лесами, группами скал, реками (замедляют движение), золотыми жилами.
	Ресурсы
- **Ресурсы:**
    
    - **Дерево:** Добывается дровосеками из деревьев. Основной ресурс для ранних построек.
    - **Камень:** Добывается шахтёрами из скал. Нужен для прочных построек и стен.
    - **Золото:** Добывается из жил или падает с врагов. Валюта для продвинутых построек, улучшений и найма солдат.
    - **Еда:** Производится на фермах. Нужна для содержания крупной армии.

- **Хранение ресурсов (Ключевое изменение):**
    
    - Ресурсы не хранятся физически в зданиях. Вместо этого существует **глобальный запас** для каждого типа ресурса, доступный всей базе.
    - **Склады (Storage)** — это здания, которые **увеличивают максимальную вместимость** (cap) для одного или нескольких типов ресурсов. Например, "Деревянный Склад" увеличивает макс. запас древесины на 200.
    - **Добыча:** Когда рабочий добывает ресурс (дерево, камень), несёт его в здание добычи после чего ресурс добавляется в соответствующий глобальный запас. **Если запас достиг своего текущего максимума, добыча прекращается.**
    - Это устраняет необходимость в логистической цепочке "здание добычи -> склад".

- **Жители (Villagers):** Базовая рабочая единица. Появляются из жилых зданий (**Хижины**) с течением времени. Каждая Хижина создаёт по 1(макс число) жителю, если житель хижины умрёт, то хижина должна создать нового. 
    
- **Состояния жителя:**
    - **Безработный (Idle):** Ждет задания.
    - **Назначен (Assigned):** Имеет рабочее место (постройку), но может быть в пути или ждать задачи.
    - **Работает (Working):** Выполняет конкретную задачу (рубит дерево, копает камень).
- **Назначение на работу:** Игрок строит ресурсное здание (например, `Домик дровосека`). После постройки здание активирует состояние **"Требуется рабочий"**. Если в пуле есть **безработный** житель, он автоматически назначается на эту работу и отправляется к зданию.

#### 3.2. Строительство и база

- **Принцип:** Свободное размещение на плоскости с привязкой к сетке.
    
- **Типы зданий:**
	- - **Жилое:**
	    - **Хижина (Hut):** создаёт 1 жителя, который сразу становится безработным, житель может существовать без хижины. Хижина нужна для создания жителя и слежением за его состоянием(жив, мёртв). Если житель мёртв(текущее кол-во жителей данной хижины меньше чем максимальное) то создаёт жителя.
	
    - **Инфраструктура:** 
	    - Склад (Storage): Увеличивает максимальную вместимость для определенных ресурсов. Не имеет физического запаса.
	    - Казармы (производят мечников), 
	    - Стрельбище (производят лучников),
	    - Кузница (улучшает атаку/броню).
        
    - - **Ресурсные здания:**
	    - **Домик дровосека (Lumberjack Hut):** Требует назначения 1 жителя. Рабочий будет самостоятельно ходить от здания к ближайшему дереву, рубить его и приносить ресурсы **обратно в здание**. Когда запас полон, рабочий перестает работать.
	    - **Каменоломня (Quarry), Ферма (Farm):** Работают по аналогичному принципу.
        
    - **Защита:** 
	    - Деревянная стена (слабая)
	    - Каменная стена (прочная)
	    - Башня лучников (огонь по площади)
	    - Пушка (AoE-урон, но медленно).
        
    - **Особые:** Алтарь Советников (здесь выбираются улучшения).
        

#### 3.3. Враги и комбат

- **Типы врагов:**
    
    - **Боец:** Ближний бой, бьёт по стенам и юнитам.
        
    - **Танк:** Много здоровья, медленный, наносит огромный урон стенам.
        
    - **Проворный:** Быстрый, обходит защиту, слабый.
        
    - **Осадный:** Дальний бой, атакует стены и башни из вне зоны их досягаемости.
        
    - **Летающий:** Игнорирует наземные препятствия, летит прямиком к цели.
        
- **ИИ врагов:**
    
    1. **Цель:** Координаты Главной Казны.
        
    2. **Поиск пути:** Использует NavMesh. Если путь заблокирован — атакует ближайшее препятствие (стену, ворота).
        
    3. **Приоритеты:** Враг будет атаковать юнитов, если те атакуют его. Иначе — движется к цели.
        
    4. **Спаун:** Волны приходят с случайного направления. За 30 сек до начала на краю карты появляется красная зона-предупреждение.
        

#### 3.4. Улучшенная система Советников (Сердце игры)

- **Активация:** После каждой успешной волны.
    
- **Процесс (2 этапа):**
    
    1. **Выбор Советника:** Игроку показываются три портрета Советников (Воин, Эконом, Маг). Каждый советник имеет **Уровень Доверия** (0-10). Игрок выбирает ОДНОГО.
        
    2. **Выбор Улучшения:** Открывается экран выбранного Советника. Игрок выбирает ОДНО из ТРЁХ предложенных улучшений его тематики.
        
- **Уровень Доверия:**
    
    - За каждый выбор советника его Уровень Доверия повышается на 1.
        
    - При достижении определенного порога (напр., 3, 6, 10) игрок получает от этого советника **мощное постоянное улучшение (Перк)**, которое действует во всех последующих играх.
        
    - Уровень не сбрасывается после смерти, это основа мета-прогрессии.
        
- **Типы улучшений (примеры):**
    
    - **Воин (Красные):** "Ядовитые клинки" (урон ядом), "Скорострельность II" (+15% к скорости атаки лучников), "Броня легионера" (+25% HP мечникам).
        
    - **Эконом (Зелёные):** "Усиленные балки" (+25% HP стенам), "Двойная добыча" (шанс получить x2 ресурса), "Экономия при строительстве" (здания стоят на 10% дешевле).
        
    - **Маг (Синие):** "Ледяная аура" (замедление врагов near башни), "Воскрешение" (шанс при смерти юнита создать скелета-союзника), "Магический ток" (башни периодически испускают ударную волну).
        
- **Перманентные Перки (примеры):**
    
    - **Воин (Ур. 3):** "Наёмники": В начале игры у вас уже есть 2 дополнительных мечника.
        
    - **Эконом (Ур. 6):** "Инфраструктура": Все здания строятся на 15% быстрее.
        
    - **Маг (Ур. 10):** "Пробуждение": Одна случайная башня на карте в начале игры уже улучшена на 1 уровень.
        

#### 3.5. Прогрессия

- **В рамках одной сессии (Run):** Улучшения от Советников и расширение базы.
    
- **Мета-прогрессия (глобальная):**
    
    - Прокачка **Уровня Доверия** с каждым из трёх советников и получение их уникальных **Перманентных Перков**.
        
    - За определённые достижения (например, "Пережить 10-ю волну", "Добыть 1000 камня") игрок получает **"Королевскую Милость"**, которую можно тратить на второстепенные глобальные улучшения:
        
        - *"Начальные ресурсы +100"*
            
        - _"Увеличить шанс появления редких улучшений на 5%"_
            
        - _"Открыть нового стартового юнита (например, Инженер)"_
            

---

### 4. Визуальный стиль и атмосфера

- **Графика:** Яркий, контрастный низкополигональный стиль (Low-Poly). Чёткое визуальное разделение юнитов, врагов, ресурсов.
    
- **Арт:** Сказочно-фэнтезийная атмосфера с лёгким мрачным оттенком (враги — гоблины, нежить, орки).
    
- **Интерфейс:** Минималистичный, чистый. Важные элементы: панель строительства, индикаторы ресурсов, таймер до следующей волны. Для системы советников — крупные, стилизованные портреты с видимой шкалой доверия.
    

---

### 5. Технические аспекты

- **Движок:** **Unity** (идеально подходит для данного жанра и стиля, огромное количество туториалов и ассетов).
    
- **Ключевые системы и плагины:**
    
    - Navmesh, Terrain, Reflex (DI), UniTask/R3 (asynchrony), Addressables (assets), PrimeTween (animation), NaughtyAttributes (editor), Cinemachine/Timeline. Open to other tools.


 [[Realm Keeper Roadmap v0.2]]